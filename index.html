<script>
    const DB = {
        mahasiswa: {
            email: "reyshan22@gmail.com",
            pass: "123",
            name: "Reyshan Mahasiswa",
            stats: [
                { label: "IPK Kumulatif", val: "3.85", icon: "fa-chart-line", col: "text-blue-400" },
                { label: "SKS Diambil", val: "22", icon: "fa-book", col: "text-indigo-400" },
                { label: "Presensi", val: "98%", icon: "fa-user-check", col: "text-emerald-400" },
                { label: "Tugas Aktif", val: "2", icon: "fa-clock", col: "text-rose-400" }
            ],
            list: ["PBO - R.302", "Struktur Data - R.401", "Analisis Sistem - Lab 2"]
        },
        dosen: {
            email: "yanto@gmail.com",
            pass: "133",
            name: "Dr. Reyshan, M.Kom",
            stats: [
                { label: "Bimbingan", val: "14", icon: "fa-users", col: "text-purple-400" },
                { label: "Mata Kuliah", val: "4", icon: "fa-chalkboard", col: "text-violet-400" },
                { label: "Publikasi", val: "3", icon: "fa-feather", col: "text-indigo-400" },
                { label: "Jadwal Hari Ini", val: "2", icon: "fa-calendar-day", col: "text-amber-400" }
            ],
            list: ["PBO A - 08:00", "AI - 10:30", "Rapat Prodi - 14:00"]
        }
    };

    const ui = {
        loginSection: document.getElementById('login-section'),
        mainContent: document.getElementById('main-content'),
        message: document.getElementById('message'),
        roleInput: document.getElementById('current-role'),
        welcomeName: document.getElementById('welcome-name'),
        statsGrid: document.getElementById('stats-grid'),
        scheduleList: document.getElementById('schedule-list'),
        userDisplayName: document.getElementById('user-display-name'),
        userDisplayEmail: document.getElementById('user-display-email'),
        roleLabel: document.getElementById('role-label'),
        navIcon: document.getElementById('nav-icon'),
        headerCard: document.getElementById('dashboard-header'),
        btnText: document.getElementById('btn-text'),
        loginBtn: document.getElementById('login-btn')
    };

    window.setRole = (role) => {
        ui.roleInput.value = role;
        document.getElementById('tab-mhs').classList.toggle('active', role === 'mahasiswa');
        document.getElementById('tab-dsn').classList.toggle('active', role === 'dosen');
    };

    document.getElementById('login-form').addEventListener('submit', (e) => {
        e.preventDefault();
        const role = ui.roleInput.value;
        const user = document.getElementById('username').value;
        const pass = document.getElementById('password').value;
        const target = DB[role];

        ui.btnText.innerHTML = '<span class="spinner"></span> Memverifikasi...';
        ui.loginBtn.disabled = true;

        setTimeout(() => {
            if (user === target.email && pass === target.pass) {
                localStorage.setItem('userRole', role);
                renderDashboard();
                ui.loginSection.classList.add('hidden-section');
                ui.mainContent.classList.remove('hidden-section');
            } else {
                showError("Email atau password salah.");
                ui.btnText.innerText = "Autentikasi";
                ui.loginBtn.disabled = false;
            }
        }, 800);
    });

    function renderDashboard() {
        const role = localStorage.getItem('userRole');
        const data = DB[role];
        const isDosen = role === 'dosen';

        ui.welcomeName.innerText = data.name;
        ui.userDisplayName.innerText = data.name;
        ui.userDisplayEmail.innerText = data.email;
        ui.roleLabel.innerText = role;

        ui.headerCard.className =
            `rounded-[2.5rem] p-10 text-white shadow-2xl mb-10 relative overflow-hidden
            ${isDosen ? 'bg-gradient-to-br from-violet-600 to-indigo-900' : 'bg-gradient-to-br from-indigo-600 to-slate-900'}`;

        ui.statsGrid.innerHTML = data.stats.map(s => `
            <div class="bg-white/5 p-6 rounded-[2rem] border border-white/5">
                <p class="text-xs text-slate-400">${s.label}</p>
                <h4 class="text-2xl font-bold">${s.val}</h4>
            </div>
        `).join('');

        ui.scheduleList.innerHTML = data.list.map(item => `
            <div class="p-4 bg-white/5 rounded-xl">${item}</div>
        `).join('');
    }

    function showError(msg) {
        ui.message.innerText = msg;
        ui.message.classList.remove('hidden-section');
    }

    document.getElementById('logout-btn').addEventListener('click', () => {
        localStorage.clear();
        location.reload();
    });
</script>
